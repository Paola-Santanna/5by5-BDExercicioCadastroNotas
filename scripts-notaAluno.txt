
CREATE TABLE [dbo].[ALUNO](
	[ID_ALUNO] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [varchar](50) NOT NULL,
 CONSTRAINT [PK_ALUNO] PRIMARY KEY CLUSTERED 
(
	[ID_ALUNO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO





CREATE TABLE [dbo].[DISCIPLINA](
	[ID_DISCIPLINA] [int] IDENTITY(1,1) NOT NULL,
	[NOME] [varchar](30) NOT NULL,
	[CARGAHORARIA] [int] NOT NULL,
 CONSTRAINT [PK_DISCIPLINA] PRIMARY KEY CLUSTERED 
(
	[ID_DISCIPLINA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO







CREATE TABLE [dbo].[ALUNODISCIPLINA](
	[ID_ALUNO] [int] NOT NULL,
	[ID_DISCIPLINA] [int] NOT NULL,
	[NOTA1] [numeric](10, 2) NULL,
	[NOTA2] [numeric](10, 2) NULL,
	[NOTASUBSTITUTIVA] [numeric](10, 2) NULL,
	[MEDIA] [numeric](10, 2) NULL,
	[HORASFALTAS] [int] NULL,
	[SITUACAO] [varchar](20) NULL,
 CONSTRAINT [PK_ALUNODISCIPLINA] PRIMARY KEY CLUSTERED 
(
	[ID_ALUNO] ASC,
	[ID_DISCIPLINA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

ALTER TABLE [dbo].[ALUNODISCIPLINA]  WITH CHECK ADD  CONSTRAINT [FK_ALUNODISCIPLINA_ALUNO] FOREIGN KEY([ID_ALUNO])
REFERENCES [dbo].[ALUNO] ([ID_ALUNO])
GO

ALTER TABLE [dbo].[ALUNODISCIPLINA] CHECK CONSTRAINT [FK_ALUNODISCIPLINA_ALUNO]
GO

ALTER TABLE [dbo].[ALUNODISCIPLINA]  WITH CHECK ADD  CONSTRAINT [FK_ALUNODISCIPLINA_DISCIPLINA] FOREIGN KEY([ID_DISCIPLINA])
REFERENCES [dbo].[DISCIPLINA] ([ID_DISCIPLINA])
GO

ALTER TABLE [dbo].[ALUNODISCIPLINA] CHECK CONSTRAINT [FK_ALUNODISCIPLINA_DISCIPLINA]
GO








--------

INSERT INTO ALUNO (NOME) VALUES ('GUILHERME')
INSERT INTO ALUNO (NOME) VALUES ('PAOLA')

INSERT INTO DISCIPLINA (NOME,CARGAHORARIA) VALUES ('MATEMATICA',300)
INSERT INTO DISCIPLINA (NOME,CARGAHORARIA) VALUES ('PORTUGUES',300)

INSERT INTO ALUNODISCIPLINA (ID_ALUNO, ID_DISCIPLINA)
VALUES (1,1)
INSERT INTO ALUNODISCIPLINA (ID_ALUNO, ID_DISCIPLINA)
VALUES (1,2)
INSERT INTO ALUNODISCIPLINA (ID_ALUNO, ID_DISCIPLINA)
VALUES (2,1)
INSERT INTO ALUNODISCIPLINA (ID_ALUNO, ID_DISCIPLINA)
VALUES (2,2)


UPDATE ALUNODISCIPLINA SET NOTA1 = 5.00, NOTA2 = 3.00, NOTASUBSTITUTIVA = 8.00, MEDIA=(8.00+5.00)/2, HORASFALTAS = 32, SITUACAO = 'APROVADO' WHERE ID_ALUNO = 1 AND ID_DISCIPLINA = 1
UPDATE ALUNODISCIPLINA SET NOTA1 = 2.00, NOTA2 = 3.00, NOTASUBSTITUTIVA = 4.00, MEDIA=(4.00+3.00)/2, HORASFALTAS = 0, SITUACAO = 'REPROVADO' WHERE ID_ALUNO = 1 AND ID_DISCIPLINA = 2

UPDATE ALUNODISCIPLINA SET NOTA1 = 8.50, NOTA2 = 6.00, NOTASUBSTITUTIVA = 0.00, MEDIA=(8.50+6.00)/2, HORASFALTAS = 8, SITUACAO = 'APROVADO' WHERE ID_ALUNO = 2 AND ID_DISCIPLINA = 1
UPDATE ALUNODISCIPLINA SET NOTA1 = 7.00, NOTA2 = 6.00, NOTASUBSTITUTIVA = 0.00, MEDIA=(7.00+6.00)/2, HORASFALTAS = 80, SITUACAO = 'REPROVADO' WHERE ID_ALUNO = 2 AND ID_DISCIPLINA = 2




------------

SELECT * FROM ALUNO

SELECT * FROM DISCIPLINA

SELECT * FROM ALUNODISCIPLINA


SELECT B.NOME, 
C. NOME, 
A.NOTA1, 
A.NOTA2, 
A.NOTASUBSTITUTIVA,
A.MEDIA, 
A.HORASFALTAS, 
C.CARGAHORARIA, 
((A.HORASFALTAS * 100) / C.CARGAHORARIA) AS PORCENTAGEMPRESENCA, 
A.SITUACAO
FROM ALUNODISCIPLINA A 
JOIN ALUNO B
ON A.ID_ALUNO = B.ID_ALUNO
JOIN DISCIPLINA C
ON A.ID_DISCIPLINA = C.ID_DISCIPLINA

